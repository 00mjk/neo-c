##########################################
# installed directories
##########################################
prefix=@prefix@ exec_prefix=@exec_prefix@
bindir=@bindir@
datadir=@datadir@
mandir=@mandir@
sharedstatedir=@sharedstatedir@
sysconfdir=@sysconfdir@/neo-c
includedir=@includedir@/neo-c
datarootdir=@datarootdir@/neo-c
docdir=@datadir@/doc
libdir=@libdir@


#########################################
# environmnet variables
##########################################
CC=@CC@
NCC=@NCC@
INSTALL=@INSTALL@
CFLAGS=@CFLAGS@
LIBS=@LIBS@
OS=@OS@
DESTDIR=@DESTDIR@

#########################################
# main
##########################################
all: vig

vig: config.h vig.nc vig1.o vig2.o vig3.o vig4.o vig5.o vig.h
	neo-c -o vig vig.nc vig1.o vig2.o vig3.o vig4.o vig5.o $(CFLAGS) $(LIBS)

vig1.o: config.h vig1.nc
	neo-c -c vig1.nc $(CFLAGS) $(LIBS)

vig2.o: config.h vig2.nc vig.h
	neo-c -c vig2.nc $(CFLAGS) $(LIBS)

vig3.o: config.h vig3.nc vig2.h
	neo-c -c vig3.nc $(CFLAGS) $(LIBS)

vig4.o: config.h vig4.nc vig3.h
	neo-c -c vig4.nc $(CFLAGS) $(LIBS)

vig5.o: config.h vig5.nc vig4.h
	neo-c -c vig5.nc $(CFLAGS) $(LIBS)

#########################################
# install
#########################################
install:
	mkdir -p "$(DESTDIR)/bin"
	$(INSTALL) -m 755 ./vig "$(DESTDIR)/bin"

#########################################
# uninstall
#########################################
uninstall:
	rm -f "$(DESTDIR)"/bin/vig

#########################################
# permission
#########################################
permission:
	chmod 644 *
	chmod 755 .git man configure
	chmod 644 *.nc
	chmod 644 *.h
	chmod 755 update_vig-c.sh

#########################################
# clean
#########################################
clean:
	rm -fR *.ll *.bc *.nc.tmp *.out *.o valgrind.txt memleack_debug.txt
	rm -fR vig

distclean: clean
	rm -fR  config.h Makefile autom4te.cache 

test:
	rm -f valgrind.txt memleack_debug.txt
	valgrind --log-file=valgrind.txt --leak-check=full --show-leak-kinds=all ./vig

